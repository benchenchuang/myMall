<%- include('../components/header.ejs') %>
    <%- include('../components/section_header.ejs') %>
    <%- include('../components/section_tabs.ejs') %>
    <style>
        .am-modal-bd{
            text-align: left;
        }
        .banner_pic{
            width: 100px;
            height: 45px;
        }
    </style>
<div class="wrap">
        <div class="tpl-portlet-components">
            <div class="portlet-title">
                <div class="caption font-green bold">
                    <span class="am-icon-code"></span> 商城轮播图
                </div>
            </div>
                <div class="widget-body">
                    <div class="am-u-sm-12 am-u-md-6 am-u-lg-6">
                        <div class="am-form-group">
                            <div class="am-btn-toolbar">
                                <div class="am-btn-group am-btn-group-xs">
                                    <a href="./add_product" type="button" class="am-btn am-btn-default am-btn-success"><span class="am-icon-plus"></span> 新增</a>
                                    <button type="button" class="am-btn am-btn-default am-btn-secondary"><span class="am-icon-save"></span> 保存</button>
                                    <button type="button" class="am-btn am-btn-default am-btn-warning"><span class="am-icon-archive"></span> 审核</button>
                                    <button type="button" class="am-btn am-btn-default am-btn-danger"><span class="am-icon-trash-o"></span> 删除</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="am-u-sm-12 am-u-md-6 am-u-lg-3">
                        <div class="am-form-group tpl-table-list-select">
                            <select data-am-selected="{btnSize: 'sm'}" style="display: none;">
                                <option value="option1">所有类别</option>
                                <option value="option2">IT业界</option>
                                <option value="option3">数码产品</option>
                                <option value="option3">笔记本电脑</option>
                                <option value="option3">平板电脑</option>
                                <option value="option3">只能手机</option>
                                <option value="option3">超极本</option>
                            </select>
                        </div>
                    </div>

                    <div class="am-u-sm-12">
                        <table width="100%" class="am-table am-table-compact am-table-striped tpl-table-black ">
                            <thead>
                                <tr>
                                    <th>缩略图</th>
                                    <th>分类</th>
                                    <th>标题</th>
                                    <th>价格</th>
                                    <th>库存</th>
                                    <th>推荐首页</th>
                                    <th>状态</th>
                                    <th>创建时间</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="gradeX"> <!-- even -->
                                    <td>
                                        <img src="assets/img/k.jpg" class="tpl-table-line-img" alt="">
                                    </td>
                                    <td class="am-text-middle"></td>
                                    <td class="am-text-middle">张鹏飞</td>
                                    <td class="am-text-middle">2016-09-26</td>
                                    <td class="am-text-middle">
                                        <div class="tpl-table-black-operation">
                                            <a href="javascript:;">
                                                <i class="am-icon-pencil"></i> 编辑
                                            </a>
                                            <a href="javascript:;" class="tpl-table-black-operation-del">
                                                <i class="am-icon-trash"></i> 删除
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                
                            </tbody>
                        </table>
                        <div id="paginations" class="am-pagination-right pagination">
                        </div>
                    </div>
                </div>
            </div>
</div>
<%- include('../components/footer.ejs') %>
<script>
    new Vue({
        el:'.wrap',
        data:{
            imgUrl:imgUrl,
            page:1,
            limit:10,
            banners:[],
        },
        created(){
            // this.getBanners();
        },
        watch:{
            page(){
                this.getBanners();
            }
        },
        methods:{
            getBanners(){
                let that=this;
                $.ajax({
                    url:getUrl+'/banners',
                    type:'get',
                    data:{
                        page:that.page,
                        limit:that.limit
                    },
                    success:function(res){
                        if(res.status==2){
                           that.banners=res.data.info;
                           that.maxPages=res.data.totalPages || 1; 
                           $('#paginations').jqPaginator({
                                totalPages: that.maxPages,
                                visiblePages: 5,
                                currentPage: that.page,
                                prev:'<li class="prev"><a href="javascript:;">上一页</a></li>',
                                next:'<li class="next"><a href="javascript:;">下一页</a></li>',
                                page: `<li class="page"><a href="javascript:;">{{page}}</a></li>`,
                                onPageChange: function (num) {
                                    that.page=num;
                                }
                            })
                        }else{
                            alertModel(res.data);
                        }
                    }
                })
            },
            del_banner(id){
                let that=this;
                $.ajax({
                    url:getUrl+'/del_banner',
                    type:'post',
                    data:{
                        id:id
                    },
                    success:function(res){
                        alertModel(res.data);
                        that.getBanners();
                    }
                })
            },
            updateStatus(id,status){
                let that=this;
                status=status==1?0:1;
                $.ajax({
                    url:getUrl+'/update_banner_status',
                    type:'post',
                    data:{
                        id:id,
                        status:status
                    },
                    success:function(res){
                        alertModel(res.data);
                        if(res.status==2){
                            that.getBanners();
                        }
                    }
                })
            }
        }
    })
</script>